<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Happy Birthday â€” Cute Interactive Page</title>
  <style>
    :root{
      --pink:#ffd6e8;
      --deep-pink:#ff66b3;
      --accent:#ff9ac2;
      --soft:#fff6fc;
      --shadow: 0 8px 30px rgba(255,85,170,0.15);
      --glass: rgba(255,255,255,0.5);
      font-family: 'Segoe UI', system-ui, -apple-system, 'Helvetica Neue', Arial;
    }
    html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--pink),#ffeef8);overflow:hidden}

    /* layered dreamy BG using the user's bg images */
    .stage{
      position:relative;height:100vh;width:100vw;overflow:hidden;display:flex;align-items:center;justify-content:center;
      background-image:
        url('https://i.pinimg.com/736x/53/23/0a/53230a0f9126fadbaeab8c836f52b677.jpg'),
        url('https://i.pinimg.com/736x/38/f2/6e/38f26e6b202cb27fe4e587f8c3455fe6.jpg'),
        linear-gradient(180deg,var(--pink),#ffeef8);
      background-size:cover,cover; /* fallback */
      background-position:center center, center center;
    }

    /* overlay vignette */
    .vignette{position:absolute;inset:0;pointer-events:none;background:radial-gradient(circle at 40% 20%, rgba(255,255,255,0.25), transparent 30%), linear-gradient(180deg, rgba(255,255,255,0.35), transparent 40%)}

    /* Big centered headline */
    .headline{position:relative;z-index:20;text-align:center;padding:2rem;border-radius:18px}
    .title{
      font-size:clamp(36px,6vw,84px);letter-spacing:1px;margin:0;color:var(--deep-pink);text-shadow:0 6px 30px rgba(255,150,200,0.2);font-weight:800;
      transform:translateY(-6px);
    }
    .subtitle{color:#ff7aa6;margin-top:6px;font-weight:600}

    /* floating balloons (decorative) */
    .balloons{position:absolute;inset:0;z-index:5;pointer-events:none}
    .balloon{position:absolute;will-change:transform;opacity:.95;filter:drop-shadow(0 12px 30px rgba(255,150,180,0.15))}
    @keyframes floaty{0%{transform: translateY(0) translateX(-2px)}50%{transform: translateY(-22px) translateX(6px)}100%{transform: translateY(0) translateX(-2px)}}

    /* candies floating across the screen */
    .candy{position:absolute;width:64px;height:64px;cursor:pointer;z-index:15;user-select:none}
    @keyframes upDown{0%{transform:translateY(0)}50%{transform:translateY(-48px)}100%{transform:translateY(0)}}

    /* small UI card area for gifts */
    .gifts{position:absolute;left:50%;transform:translateX(-50%);bottom:40px;display:flex;gap:22px;z-index:30}
    .gift{width:110px;height:110px;border-radius:14px;background:linear-gradient(180deg,var(--soft),#fff);box-shadow:var(--shadow);display:flex;align-items:center;justify-content:center;cursor:pointer;position:relative;overflow:visible}
    .gift img{max-width:88%;max-height:88%;pointer-events:none}
    .gift .label{position:absolute;bottom:-18px;left:50%;transform:translateX(-50%);background:var(--glass);padding:4px 8px;border-radius:12px;font-size:12px;color:#b03b6a}

    /* popup wish bubble */
    .wish{position:fixed;left:50%;top:16%;transform:translateX(-50%);z-index:60;padding:14px 20px;background:white;border-radius:18px;box-shadow:0 10px 40px rgba(0,0,0,0.12);font-weight:700;color:var(--deep-pink);display:none}

    /* letter modal */
    .modal{position:fixed;inset:0;background:rgba(20,8,20,0.35);display:flex;align-items:center;justify-content:center;z-index:70;backdrop-filter: blur(4px);display:none}
    .card{background:linear-gradient(180deg,#fff, #fff7fb);padding:18px;border-radius:18px;box-shadow:var(--shadow);max-width:92%;max-height:80%;}
    .letter{width:360px;height:500px;background-size:contain;background-position:center;background-repeat:no-repeat}

    /* flipbook area */
    .flipwrap{position:relative;width:220px;height:160px;perspective:1200px}
    .page{position:absolute;width:100%;height:100%;left:0;top:0;border-radius:8px;backface-visibility:hidden;transform-origin:left;box-shadow:0 8px 30px rgba(0,0,0,0.12);overflow:hidden}
    .page img{width:100%;height:100%;object-fit:cover}

    /* bouquet big view */
    .big-bouq{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);z-index:75;display:none}
    .big-bouq img{max-width:80vw;max-height:80vh;border-radius:12px;box-shadow:var(--shadow)}

    /* cake area */
    .cake-area{position:relative;width:120px;height:120px;border-radius:70px;display:flex;align-items:center;justify-content:center}
    .candle{position:absolute;top:6px;width:8px;height:28px;border-radius:3px;background:linear-gradient(#fff,#ffd6d6);box-shadow:0 2px 6px rgba(0,0,0,0.08)}
    .flame{position:absolute;top:-10px;left:50%;transform:translateX(-50%);width:14px;height:18px;border-radius:50% 50% 40% 40%;background:radial-gradient(circle at 45% 35%,#fff7c9,#ffb84d);box-shadow:0 8px 18px rgba(255,130,100,0.18)}
    .candles-off .flame{animation:none;opacity:0;transform:translateX(-50%) translateY(-6px) scale(0.6);transition:all .45s ease}

    /* small helpers */
    .hidden{display:none}
    .center{display:flex;align-items:center;justify-content:center}

    /* fallback styling if autocrop fails - slightly mask bg */
    .autocrop-failed{background:linear-gradient(0deg, rgba(255,255,255,0.9), rgba(255,255,255,0.6));padding:6px;border-radius:8px}

    /* responsive tweaks */
    @media (max-width:600px){.gifts{gap:12px;bottom:22px}.gift{width:88px;height:88px}.title{font-size:36px}}
  </style>
</head>
<body>
  <div class="stage" id="stage">
    <div class="vignette"></div>

    <!-- decorative floating balloons -->
    <div class="balloons" aria-hidden="true">
      <img src="https://i.pinimg.com/1200x/48/c7/02/48c70227e94581e880ea1a063b669ba6.jpg" class="balloon" style="left:6%;top:12%;width:130px;animation:floaty 6s ease-in-out infinite;"/>
      <img src="https://i.pinimg.com/1200x/fa/f5/96/faf5961ee7ddc7646d295fa24dde2d65.jpg" class="balloon" style="right:6%;top:4%;width:110px;animation:floaty 7s ease-in-out infinite;"/>
    </div>

    <!-- headline -->
    <div class="headline">
      <h1 class="title">Happy Birthday!</h1>
      <div class="subtitle">Wishing you sweetness, sparkles and lots of love ðŸ’–</div>
    </div>

    <!-- candies (clickable) -->
    <img src="https://i.pinimg.com/1200x/4d/f8/a8/4df8a8e61ba115aaafcbc9adedaf7bb1.jpg" class="candy autocrop" data-threshold="240" style="left:12%;bottom:22%;animation:upDown 4s ease-in-out infinite;" data-msg="Sweet wishes!"/>
    <img src="https://i.pinimg.com/1200x/50/77/7c/50777cf3e39dfb484cb3f6bf7373e41b.jpg" class="candy autocrop" data-threshold="240" style="left:26%;bottom:12%;width:56px;height:56px;animation:upDown 5s linear infinite;" data-msg="May your day sparkle!"/>
    <img src="https://i.pinimg.com/736x/42/d8/22/42d8227a9535469740547bb7a09c7c99.jpg" class="candy autocrop" data-threshold="240" style="right:18%;bottom:20%;width:72px;height:72px;animation:upDown 4.6s ease-in-out infinite;" data-msg="Lots of candy kisses!"/>
    <img src="https://i.pinimg.com/1200x/e0/b9/42/e0b94238943e6c185547fb235a790d8c.jpg" class="candy autocrop" data-threshold="240" style="left:52%;bottom:30%;width:84px;height:84px;animation:upDown 3.6s ease-in-out infinite;" data-msg="Make a wish!"/>

    <!-- bows fixed top corners -->
    <img src="https://i.pinimg.com/1200x/4e/ee/40/4eee400c24a75b2f37aad6c08e135670.jpg" class="balloon" style="left:2%;top:6%;width:80px;transform:scale(.9);"/>
    <img src="https://i.pinimg.com/1200x/48/c7/02/48c70227e94581e880ea1a063b669ba6.jpg" class="balloon" style="right:2%;top:6%;width:80px;transform:scale(.9);"/>

    <!-- wish bubble -->
    <div id="wish" class="wish">You clicked a candy!</div>

    <!-- gifts bar -->
    <div class="gifts" id="gifts">
      <div class="gift" id="gift-letter" title="Open letter">
        <img src="https://i.pinimg.com/1200x/ed/95/52/ed955257193d292dca3b6a36b0b3cf68.jpg" class="autocrop" data-threshold="250"/>
        <div class="label">Letter</div>
      </div>

      <div class="gift" id="gift-flip" title="Flip book">
        <div class="flipwrap center" id="flipwrap"></div>
        <div class="label">Flip Book</div>
      </div>

      <div class="gift" id="gift-bouq" title="Bouquet">
        <img src="birthdaytemp/boqe.png" class="autocrop" data-threshold="230"/>
        <div class="label">Bouquet</div>
      </div>

      <div class="gift" id="gift-cake" title="Cake">
        <div class="cake-area" id="cake-area">
          <img src="https://i.pinimg.com/1200x/87/be/d2/87bed272c1fd7bf9a4f08e33cabe3c3e.jpg" style="width:92%;height:92%;object-fit:contain;border-radius:12px;" />
          <div class="candle" style="left:40%"><div class="flame"></div></div>
          <div class="candle" style="left:60%"><div class="flame"></div></div>
        </div>
        <div class="label">Cake</div>
      </div>
    </div>

    <!-- letter modal -->
    <div id="modal" class="modal">
      <div class="card center">
        <div class="letter" id="letter" style="background-image:url('https://i.pinimg.com/1200x/ed/95/52/ed955257193d292dca3b6a36b0b3cf68.jpg');"></div>
      </div>
    </div>

    <!-- flipbook modal (uses same modal region for simplicity) -->
    <div id="flip-modal" class="modal" style="display:none">
      <div class="card center" style="padding:12px">
        <div class="flipwrap" id="flipmodalwrap"></div>
      </div>
    </div>

    <!-- big bouquet view -->
    <div id="big-bouq" class="big-bouq">
      <img src="birthdaytemp/boqe.png" alt="Bouquet"/>
    </div>

  </div>

  <script>
    /* ========== Auto-crop script: tries to remove light backgrounds by drawing to canvas. ========== */
    async function makeTransparent(imgEl, threshold = 250) {
      return new Promise((resolve, reject) => {
        const img = new Image();
        img.crossOrigin = 'anonymous';
        img.onload = () => {
          try {
            const w = img.width, h = img.height;
            const canvas = document.createElement('canvas');
            canvas.width = w; canvas.height = h;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(img, 0, 0);
            const imd = ctx.getImageData(0, 0, w, h);
            const d = imd.data;
            for (let i = 0; i < d.length; i += 4) {
              const r = d[i], g = d[i+1], b = d[i+2];
              const lum = 0.2126*r + 0.7152*g + 0.0722*b;
              if (lum >= threshold) { d[i+3] = 0; }
            }
            ctx.putImageData(imd, 0, 0);
            const dataUrl = canvas.toDataURL('image/png');
            resolve(dataUrl);
          } catch (err) { reject(err); }
        };
        img.onerror = (e) => reject(new Error('Failed to load (CORS or network): ' + imgEl.src));
        img.src = imgEl.src;
      });
    }

    async function processAll() {
      const imgs = Array.from(document.querySelectorAll('img.autocrop'));
      for (const el of imgs) {
        const t = parseInt(el.dataset.threshold || '250', 10);
        try {
          const png = await makeTransparent(el, t);
          el.src = png;
        } catch (err) {
          console.warn('Autocrop failed for', el.src, err);
          el.classList.add('autocrop-failed');
          // fallback: add subtle background so it looks cohesive
          el.style.background = 'linear-gradient(180deg, rgba(255,250,255,0.6), rgba(255,240,250,0.4))';
          el.style.padding = '4px';
          el.style.borderRadius = '8px';
        }
      }
    }
    document.addEventListener('DOMContentLoaded', processAll);

    /* ========== Candy click -> show wish for 2s ========== */
    document.querySelectorAll('.candy').forEach(c => {
      c.addEventListener('click', (e)=>{
        const msg = c.dataset.msg || 'Happy Birthday!';
        const w = document.getElementById('wish');
        w.textContent = msg;
        w.style.display = 'block';
        w.animate([{opacity:0, transform:'translateY(-6px)'},{opacity:1, transform:'translateY(0)'}],{duration:280,easing:'cubic-bezier(.2,.9,.3,1)'});
        setTimeout(()=>{ w.animate([{opacity:1, transform:'translateY(0)'},{opacity:0, transform:'translateY(-10px)'}],{duration:260}); setTimeout(()=>w.style.display='none',260); },2000);
      });
    });

    /* ========== Letter popup (auto close after 5s) ========== */
    const modal = document.getElementById('modal');
    document.getElementById('gift-letter').addEventListener('click', ()=>{
      modal.style.display = 'flex';
      setTimeout(()=>{ modal.style.display='none' },5000);
    });
    modal.addEventListener('click', (e)=>{ if(e.target===modal) modal.style.display='none' });

    /* ========== Flipbook: create a few pages, flip them then disappear ========== */
    function makeFlipbook(container, pages, autoFlip=true) {
      container.innerHTML='';
      pages.forEach((src,i)=>{
        const p = document.createElement('div'); p.className='page'; p.style.zIndex = pages.length - i;
        const img = document.createElement('img'); img.src = src; p.appendChild(img);
        container.appendChild(p);
      });
    }

    // when flip gift clicked, show modal with flipping pages
    document.getElementById('gift-flip').addEventListener('click', async ()=>{
      const wrap = document.getElementById('flipmodalwrap');
      const modalF = document.getElementById('flip-modal');
      modalF.style.display = 'flex';
      // basic pages (we'll reuse some candy/bow pics to make it cute)
      const pages = [
        'https://i.pinimg.com/1200x/4e/ee/40/4eee400c24a75b2f37aad6c08e135670.jpg',
        'https://i.pinimg.com/1200x/4d/f8/a8/4df8a8e61ba115aaafcbc9adedaf7bb1.jpg',
        'https://i.pinimg.com/1200x/e3/88/4f/e3884f7273a72417ca80633056efb961.jpg'
      ];
      makeFlipbook(wrap, pages);
      // do an animated flip sequence
      const pageEls = Array.from(wrap.querySelectorAll('.page'));
      let idx = 0;
      const flipInterval = setInterval(()=>{
        if(idx>=pageEls.length) { clearInterval(flipInterval); setTimeout(()=>{ modalF.style.display='none' },400); return; }
        const p = pageEls[idx];
        p.style.transition='transform 700ms cubic-bezier(.2,.9,.3,1), opacity 400ms';
        p.style.transform='rotateY(-180deg)';
        p.style.opacity='0';
        idx++;
      },850);

      // click outside to close early
      modalF.addEventListener('click', (ev)=>{ if(ev.target===modalF){ modalF.style.display='none'; }}, {once:true});
    });

    /* ========== Bouquet -> big view ========== */
    document.getElementById('gift-bouq').addEventListener('click', ()=>{
      const b = document.getElementById('big-bouq'); b.style.display='block';
      b.animate([{opacity:0, transform:'translate(-50%,-44%) scale(.92)'},{opacity:1, transform:'translate(-50%,-50%) scale(1)'}],{duration:360});
      setTimeout(()=>{ b.style.display='none' },4000);
    });

    /* ========== Cake -> blow candles (hide flames) ========== */
    const cakeGift = document.getElementById('gift-cake');
    const cakeArea = document.getElementById('cake-area');
    cakeGift.addEventListener('click', ()=>{
      cakeArea.classList.add('candles-off');
      // make a little confetti burst (pseudo)
      const conf = document.createElement('div'); conf.style.position='absolute'; conf.style.left='50%'; conf.style.top='40%'; conf.style.width='200px'; conf.style.height='200px'; conf.style.pointerEvents='none'; conf.style.zIndex=120; cakeGift.appendChild(conf);
      conf.animate([{opacity:1, transform:'translateY(0) scale(1)'},{opacity:0, transform:'translateY(-80px) scale(1.6)'}],{duration:900}).onfinish=()=>conf.remove();
      // toggle flames back after 3s so user can blow again
      setTimeout(()=> cakeArea.classList.remove('candles-off'),3000);
    });

    /* small accessibility: keyboard focus on gifts */
    Array.from(document.querySelectorAll('.gift')).forEach(g=>{ g.tabIndex=0; g.addEventListener('keydown', (e)=>{ if(e.key==='Enter'||e.key===' ') g.click(); }); });

    // small animation for title heartbeat
    const title = document.querySelector('.title');
    setInterval(()=>{ title.animate([{transform:'scale(1)'},{transform:'scale(1.03)'},{transform:'scale(1)'}],{duration:2200,iterations:1}); },3600);

  </script>
</body>
</html>
